% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/identify_core.R
\name{identify_core}
\alias{identify_core}
\title{Identify Core Microbial Taxa}
\usage{
identify_core(physeq_obj, priority_var, increase_value = 0.02, seed = NULL)
}
\arguments{
\item{physeq_obj}{A \code{phyloseq} object with \code{otu_table} and
\code{sample_data}.}

\item{priority_var}{Bare column name \emph{or} a string naming a column in
\code{sample_data(physeq_obj)} (e.g., \code{sampling_date}, \code{"Site"}).
This variable defines the groups in which per-group presence frequency is
calculated.}

\item{increase_value}{Numeric scalar (default \code{0.02}) used for the
BC-increase threshold. The cut is taken at the last rank where
\code{IncreaseBC >= 1 + increase_value}.}

\item{seed}{Optional integer to set the RNG seed for reproducibility.}
}
\value{
A list with:
\itemize{
\item \code{bray_curtis_ranked} tibble with \code{rank}, mean BC across
sample pairs at each cumulative rank, normalized proportion, the
multiplicative \code{IncreaseBC}, and the elbow helper metric.
\item \code{otu_ranked} tibble with \code{otu} and composite \code{rank}.
\item \code{occupancy_abundance} tibble with \code{otu}, occupancy
(\code{otu_occ}) and mean relative abundance (\code{otu_rel}).
\item \code{elbow} core set identified by elbow method (integer).
\item \code{bc_increase} core set identified by last \% BC-increase (integer).
\item \code{increase_value} \% increase value used in the calculation.
\item \code{elbow_core} core OTU/ASVs using elbow method (character vector).
\item \code{increase_core} core OTU/ASVs using last \% BC-increase method (character vector).
\item \code{otu_table} otu_table counts (otu x samples) used (data.frame).
\item \code{sample_metadata} samples metadata (data.frame).
\item \code{taxonomy_table} taxonomy if present (data.frame); otherwise NULL.
}
}
\description{
This function identifies core microbial taxa based on abundance-occupancy
distributions and their contributions to Bray-Curtis dissimilarity. Core taxa
are selected using either the "increase" or "elbow" method. This fucntion
implements the method developed by Shade and Stopnisek (2019) Curr Opin
Microbiol, see below for details.
}
\details{
The function ranks taxa by a composite index (occupancy + "core within group"
frequency) computed per level of a user-specified sample metadata variable (e.g.,
sampling_date,  genotype, site). Then, it simulates Bray-Curtis (BC) accumulation across
samples while iteratively adding taxa in rank order to find (1) an "elbow"
cut and (2) a multiplicative BC-increase threshold cut to prioritize the core set.
}
\section{Dependencies}{

Requires \pkg{phyloseq}, \pkg{dplyr}, \pkg{tidyr}, \pkg{tibble}, \pkg{rlang},
and \pkg{vegan}.
}

\examples{
\dontshow{if (requireNamespace("phyloseq", quietly = TRUE)) withAutoprint(\{ # examplesIf}
\donttest{
  # Example using your switchgrass phyloseq object and grouping variable 'sampling_date'
  data("switchgrass", package = "BRCore")

  res <- identify_core(
    physeq_obj     = switchgrass,
    priority_var   = "sampling_date",
    increase_value = 0.02,
    seed           = 091825
  )

  # Inspect results
  str(res)
}
\dontshow{\}) # examplesIf}
}
\references{
Ashley Shade and Nejc Stopnisek (2019) Abundance-occupancy
distributions to prioritize plant core microbiome membership. Current
Opinion in Microbiology, 49:50-58 DOI:https://doi.org/10.1016/j.mib.2019.09.008
}

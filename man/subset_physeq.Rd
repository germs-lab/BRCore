% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/subset_physeq.R
\name{subset_physeq}
\alias{subset_physeq}
\title{Subset phyloseq object based on core analysis results}
\usage{
subset_physeq(core_obj, physeq, .var, type)
}
\arguments{
\item{core_obj}{A list object containing core microbiome analysis results.
Expected to contain a dataframe at position \code{[[4]]} with OTU information.}

\item{physeq}{A phyloseq object to be subsetted.}

\item{.var}{Character string specifying the column name in \code{core_obj[[4]]}
containing sample/group identifiers to filter by.}

\item{type}{Value to filter by in the 'fill' column of \code{core_obj[[4]]}.
Determines which OTUs are retained.}
}
\value{
A list containing two elements:
\itemize{
\item \code{expected_physeq} - Subsetted phyloseq object
\item \code{asv_matrix} - Corresponding ASV abundance matrix
}
}
\description{
Filters a phyloseq object to retain only samples and taxa identified in a core microbiome analysis
using \code{extract_core()}.
Returns both the subsetted phyloseq object and corresponding ASV matrix.
}
\details{
This function performs the following operations:
\enumerate{
\item Extracts OTUs of interest from the core analysis object based on the specified type
\item Filters the phyloseq object to retain only these OTUs and samples where they appear
\item Verifies the filtering was successful
\item Returns both the subsetted phyloseq object and ASV matrix
}

The function uses \code{prune_samples} and \code{prune_taxa} to safely subset the phyloseq object
while preserving all associated data (sample data, taxonomy table, etc.). The ASV matrix is
processed to remove samples with zero row sums.
}
\examples{
\dontrun{
# Subset for "persistent" core OTUs
result <- subset_physeq(
  core_obj = my_core_results,
  physeq = my_phyloseq,
  .var = "body_site",
  type = "persistent"
)

# Access results
subset_physeq <- result$expected_physeq
asv_matrix <- result$asv_matrix
}

}

% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/misc_functions.R
\name{extract_matrix}
\alias{extract_matrix}
\title{Extract ASV/OTU Matrix from phyloseq or Matrix Object}
\usage{
extract_matrix(physeq, .vec, keep_rows_sums = 0, taxa_are_rows = TRUE)
}
\arguments{
\item{physeq}{A \code{phyloseq} or \code{matrix} object containing ASV/OTU data.
If a \code{phyloseq} object is provided, the OTU table is extracted.
If a \code{matrix} is provided, it is used directly.}

\item{.vec}{A character string or vector specifying the columns to select from the matrix.
This is passed to \code{dplyr::select(contains(.vec))} to filter the matrix.}

\item{keep_rows_sums}{A numeric value specifying the minimum row sum required to keep a sample.
Rows (samples) with sums less than or equal to this value are removed. Default is \code{0}.}

\item{taxa_are_rows}{A logical value specifying whether the taxa are rows in the matrix. Default is \code{TRUE}.}
}
\value{
A matrix with samples as rows and ASVs/OTUs as columns. Only samples matching
the \code{.vec} criteria and with row sums greater than \code{keep_rows_sums} are retained.
}
\description{
This function extracts an ASV/OTU matrix from a \code{phyloseq} or \code{matrix} object.
It ensures the matrix is in the correct format (samples as rows and ASVs as columns)
and filters samples based on a specified vector and row sums.
}
\examples{
# Load phyloseq object
data(GlobalPatterns, package = "phyloseq")

# Extract matrix for samples containing "Feces" in their names
fec_matrix <- extract_matrix(GlobalPatterns, .vec = "Feces", keep_rows_sums = 10)

# View the extracted matrix
head(fec_matrix)
}
